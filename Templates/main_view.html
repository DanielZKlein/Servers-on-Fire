<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Servers on fire</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le styles -->
    <link href="{{url}}stuff/bootstrap.css" rel="stylesheet">
    <link href="{{url}}stuff/bootstrap-responsive.css" rel="stylesheet">
    <link href="{{url}}stuff/sof.css" rel="stylesheet">

	
    <!-- Le fav and touch icons -->
  </head>

  <body>
  <div id="ajaxstatus">synced</div>

  <div class="navbar navbar-fixed-top">
	<div class="navbar-inner">
		<div class="container" style="width: 100%; height: 85px; background-color: black;">
			<div class="row-fluid">
				<div class="span1">
					<img class="pull-left navbarpic" src="{{url}}stuff/riotlogo81.png" />
				</div>
				<div class="span7">
					<div class="sofheader">Servers on Fire</div>
					<div class="sofsubhead">Emergency Messaging Tool</div>
				</div>
				<div id="logins" class="span4 pull-right">
					<p id="loginsheader">Login to all required shards</p>
					<p id="loginstatus">NA: <span class="notloggedin">not logged in</span> | EUW: <span class="loggedin">logged in</span> | EUNE: <span class="notloggedin">not logged in</span> </p>
					<p id="loginbuttonp"><input type="button" value="Login" id="loginbutton" /></p>
				</div>
			</div>
		</div>
	</div>
</div>


<div class="container-fluid" style="margin-top: 85px;">
	<div class="row-fluid">
		<div class="span3">
			<p class="searchheader">Select or search for a subject</p>
			<input type="text" id="subjectsearch">
			<div id="subjectresults">Subjects</div>
			<div id="subjects"></div>
		</div>
		<div class="span9 hidden" id="bodysearchdiv">
			<p class="searchheader">Select or search for a message body</p>
			<input type="text" id="bodysearch">
			<p id="bodyresults">Message bodies</p>
			<div id="bodies"></div>
		</div>
	</div>
	<div id="reviewpane" class="hidden">
		<div class="row-fluid">
			<div class="span12">
				<p class="searchheader">Review localized previews</p>
			</div>
		</div>
		<div class="row-fluid">
			<div class="span10">
				<div class="row-fluid">
					<div class="span2 reviewheader">Region/Time</div>
					<div class="span8 reviewheader">Localized message to be posted in forum (subject in <b>bold</b>)</div>
				</div>
				<div id="previewscroll">
					{% for shortcut, data in locaData.items %}
					<div class="row-fluid previewrow">
						<div class="span2 regioncell">
							<p class="regionheader">{{data.region}}</p>
							<p class="regiontime"><span id="{{shortcut}}time">xx:xx</span> ({{data.tz}})</p>
							<p>
							  <label class="checkbox"><input class="pcheck" data-shortcut="{{shortcut}}" id="{{shortcut}}publish" type="checkbox"> Publish in this language</label>
							</p>
						</div>
						<div class="span8 messagecell">
							<p id="{{shortcut}}subject"><b>{{shortcut}} subject</b></p>
							<p id="{{shortcut}}body">{{shortcut}} body</p>
						</div>
					</div>
					{% endfor %}
			
				</div>
			</div>
			<div class="span2" id="doitpane">
				<p><input type="button" class="btn" id="selectall" value="Select all regions"></p>
				<p><label class="checkbox"><input type="checkbox" class="tstamp" id="timestampit">Add timestamps</label></p>
				<p><span id="pleaseselectone">Please select at least one region</span></p>
				<p><input type="button" id="doitbutton" class="btn btn-primary disabled" value="Publish to selected forums"></p>
			</div>
		</div>
	</div>	
</div> <!-- /container -->

<div class="modal hide" id="doitmodal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">x</button>
    <h3>Publish emergency messaging</h3>
  </div>
  <div class="modal-body">
    <p>Are you sure you want to post in the following languages:</p>
	<div id="modalregions">
	
	</div>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Cancel</a>
    <a href="#" id="modalpublish" class="btn btn-primary">Publish</a>
  </div>
</div>
	

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	<script src="{{url}}stuff/sof.js" type="text/javascript"></script>

    <script src="{{url}}stuff/jquery.js"></script>
    <script src="{{url}}stuff/bootstrap-transition.js"></script>
    <script src="{{url}}stuff/bootstrap-alert.js"></script>
    <script src="{{url}}stuff/bootstrap-modal.js"></script>
    <script src="{{url}}stuff/bootstrap-dropdown.js"></script>
    <script src="{{url}}stuff/bootstrap-scrollspy.js"></script>
    <script src="{{url}}stuff/bootstrap-tab.js"></script>
    <script src="{{url}}stuff/bootstrap-tooltip.js"></script>
    <script src="{{url}}stuff/bootstrap-popover.js"></script>
    <script src="{{url}}stuff/bootstrap-button.js"></script>
    <script src="{{url}}stuff/bootstrap-collapse.js"></script>
    <script src="{{url}}stuff/bootstrap-carousel.js"></script>
    <script src="{{url}}stuff/bootstrap-typeahead.js"></script>
	<script>
	// Load all messages and translations into javascript
	document.subjects = [];
	{% for subject in subjects %}
	document.subjects[{{subject.id}}] = [];
	document.subjects[{{subject.id}}]['english'] = "{{subject.english|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['german'] = "{{subject.german|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['french'] = "{{subject.french|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['spanish'] = "{{subject.spanish|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['polish'] = "{{subject.polish|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['romanian'] = "{{subject.romanian|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['greek'] = "{{subject.greek|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['korean'] = "{{subject.korean|linebreaksbr|escapejs}}";
	document.subjects[{{subject.id}}]['id'] = "{{subject.id}}";

	{% endfor %}

	document.bodies = [];
	{% for body in bodies %}
	document.bodies[{{body.id}}] = [];
	document.bodies[{{body.id}}]['english'] = "{{body.english|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['german'] = "{{body.german|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['french'] = "{{body.french|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['spanish'] = "{{body.spanish|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['polish'] = "{{body.polish|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['romanian'] = "{{body.romanian|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['greek'] = "{{body.greek|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['korean'] = "{{body.korean|linebreaksbr|escapejs}}";
	document.bodies[{{body.id}}]['id'] = "{{body.id}}";

	{% endfor %}

	document.locaData = [];
	{% for shortcut, data in locaData.items %}
	document.locaData['{{shortcut}}'] = [];
	document.locaData['{{shortcut}}']['language'] = '{{data.language}}';
	document.locaData['{{shortcut}}']['region'] = '{{data.region}}';
	document.locaData['{{shortcut}}']['forumurl'] = '{{data.forumurl}}';
	document.locaData['{{shortcut}}']['tz'] = '{{data.tz}}';
	document.locaData['{{shortcut}}']['datefmt'] = '{{data.datefmt}}';
	document.locaData['{{shortcut}}']['timefmt'] = '{{data.timefmt}}';
	{% endfor %}
	
	</script>
	<script type="text/javascript">
		$(function() {
			
			// ready function
			document.myURL = '{{url}}';
			bindStatics();
			checkSync();
			updateBodies();
			updateSubjects();
			timeTick();

		});
	</script>


  </body>
</html>
